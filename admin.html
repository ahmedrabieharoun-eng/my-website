<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Firebase</title>
  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.2/firebase-database.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.0/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body { font-family: "Tajawal", sans-serif; }
    .card { @apply bg-gray-800 p-4 rounded-xl shadow-md mb-4 border border-gray-700; }
    textarea { direction: ltr; }
  </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">
  <header class="bg-gray-800 shadow-md p-4 text-center">
    <h1 class="text-3xl font-bold text-amber-400">âš™ï¸ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Firebase</h1>
  </header>

  <main class="max-w-6xl mx-auto p-6">
    <!-- Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© -->
    <section class="card">
      <h2 class="text-xl font-semibold mb-3 text-green-400">â• Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
        <input id="newKey" placeholder="ğŸ”‘ Ø§Ù„Ù…ÙØªØ§Ø­ (key)" class="p-2 rounded bg-gray-700 text-white w-full">
        <textarea id="newValue" placeholder="Ø§Ù„Ù‚ÙŠÙ…Ø© (JSON Ø£Ùˆ Ù†Øµ)" class="p-2 rounded bg-gray-700 text-white w-full h-24"></textarea>
      </div>
      <button id="addBtn" class="mt-3 bg-green-600 px-5 py-2 rounded hover:bg-green-500">Ø¥Ø¶Ø§ÙØ©</button>
    </section>

    <!-- Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
    <section id="dataContainer" class="card">
      <h2 class="text-xl font-semibold mb-2 text-blue-400">ğŸ“ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase</h2>
      <p class="text-gray-400 text-center">Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
    </section>
  </main>

  <footer class="text-center text-gray-500 mt-10 text-sm">
    ğŸ§  Ù„ÙˆØ­Ø© Ù…Ø·ÙˆØ±Ø© Ø¨ÙˆØ§Ø³Ø·Ø© <span class="text-amber-400 font-semibold">Ahmed Rabie</span>
  </footer>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
    import { getDatabase, ref, onValue, set, remove, update } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-database.js";

    const firebaseConfig = {
    apiKey: "AIzaSyBVagvNXYSADrSoALrysaWkTjLfZZ-wtJ0",
    authDomain: "mmadnan9k-63525.firebaseapp.com",
    databaseURL: "https://mmadnan9k-63525-default-rtdb.firebaseio.com",
    projectId: "mmadnan9k-63525",
    storageBucket: "mmadnan9k-63525.firebasestorage.app",
    messagingSenderId: "336186568291",
    appId: "1:336186568291:web:ad71f1cf2fe1baf6501256",
    measurementId: "G-5PZBK5VZ4Q"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const dbRef = ref(db, '/');
    const dataContainer = document.getElementById("dataContainer");

    // Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø´ÙƒÙ„ Ù…Ù†Ø³Ù‚
    onValue(dbRef, (snapshot) => {
      const data = snapshot.val();
      if (!data) {
        dataContainer.innerHTML = "<p class='text-center text-gray-400'>ğŸš« Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</p>";
        return;
      }

      let html = "";
      for (const key in data) {
        html += `
          <details class="bg-gray-700 rounded-lg mb-3 p-3">
            <summary class="cursor-pointer text-lg font-bold text-amber-400">${key}</summary>
            <textarea id="val-${key}" class="w-full bg-gray-900 text-gray-100 p-3 mt-2 rounded h-40">${JSON.stringify(data[key], null, 2)}</textarea>
            <div class="mt-2 flex gap-2">
              <button onclick="updateData('${key}')" class="bg-blue-600 px-3 py-1 rounded hover:bg-blue-500">ğŸ’¾ ØªØ¹Ø¯ÙŠÙ„</button>
              <button onclick="deleteData('${key}')" class="bg-red-600 px-3 py-1 rounded hover:bg-red-500">ğŸ—‘ Ø­Ø°Ù</button>
            </div>
          </details>
        `;
      }
      dataContainer.innerHTML = html;
    });

    // Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­ÙƒÙ…
    window.updateData = (key) => {
      const newVal = document.getElementById(`val-${key}`).value;
      try {
        const parsedVal = JSON.parse(newVal);
        update(ref(db, key), parsedVal);
        alert("âœ… ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!");
      } catch (e) {
        alert("âš ï¸ ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ JSON ØµØ­ÙŠØ­!");
      }
    };

    window.deleteData = (key) => {
      if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ${key}ØŸ`)) {
        remove(ref(db, key));
      }
    };

    document.getElementById("addBtn").addEventListener("click", () => {
      const key = document.getElementById("newKey").value.trim();
      const val = document.getElementById("newValue").value.trim();
      if (!key || !val) return alert("âš ï¸ Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…ÙØªØ§Ø­ ÙˆØ§Ù„Ù‚ÙŠÙ…Ø© Ø£ÙˆÙ„Ø§Ù‹!");

      try {
        const parsed = JSON.parse(val);
        set(ref(db, key), parsed);
      } catch {
        set(ref(db, key), val);
      }
      alert("âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¬Ø§Ø­!");
    });
  </script>
</body>
</html>

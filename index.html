<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>GLX Galaxy - Secure Access</title>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <!-- Ad Network 1: Monetag/Libtl -->
    <script src="//libtl.com/sdk.js" data-zone="10286382" data-sdk="show_10286382" async></script>
    
    <!-- Ad Network 2: GigaPub -->
    <script src="https://ad.gigapub.tech/script?id=4102"></script>

    <!-- Ad Network 3: AdsGram -->
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&display=swap');
        
        :root {
            --primary-green: #a855f7;
            --deep-Galaxy: #202020;
            --gold: #d6bcfa;
            --gold-glow: rgba(168, 85, 247, 0.4);
            --glass-bg: rgba(32, 32, 32, 0.7);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-color: #ffffff;
            --text-muted: #b0b0b0;
            --nav-bg: rgba(40, 40, 40, 0.98);
            --success-color: #a855f7;
            --error-color: #e74c3c;
            --warning-color: #f39c12;
            --info-color: #3498db;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            font-family: 'Outfit', sans-serif; 
            color: var(--text-color); 
            overflow-x: hidden; 
            background-image: url('https://i.ibb.co/RGFp67kJ/121.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, rgba(50,50,50,0.3) 0%, rgba(30,30,30,0.85) 100%);
            z-index: -1;
        }
        
        /* نظام رسائل التحقق والأمان */
        .verification-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: #fff;
            font-family: 'Outfit', sans-serif;
        }

        .verification-card {
            background: var(--glass-bg);
            backdrop-filter: blur(30px);
            border-radius: 30px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            border: 2px solid var(--primary-green);
            box-shadow: 0 20px 60px rgba(168, 85, 247, 0.4);
            text-align: center;
        }

        .verification-icon {
            font-size: 70px;
            margin-bottom: 25px;
            animation: pulse 2s infinite;
        }

        .verification-title {
            font-size: 26px;
            font-weight: 800;
            margin-bottom: 15px;
            color: #fff;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .verification-message {
            font-size: 16px;
            color: var(--text-muted);
            line-height: 1.6;
            margin-bottom: 25px;
            padding: 0 20px;
        }

        .verification-details {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: left;
        }

        .verification-step {
            display: flex;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            margin-bottom: 10px;
            border-left: 4px solid transparent;
        }

        .verification-step.checking {
            border-left-color: var(--warning-color);
            background: rgba(243, 156, 18, 0.1);
        }

        .verification-step.success {
            border-left-color: var(--success-color);
            background: rgba(39, 174, 96, 0.1);
        }

        .verification-step.error {
            border-left-color: var(--error-color);
            background: rgba(231, 76, 60, 0.1);
        }

        .step-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 18px;
            flex-shrink: 0;
        }

        .step-icon.checking {
            background: rgba(243, 156, 18, 0.2);
            color: var(--warning-color);
        }

        .step-icon.success {
            background: rgba(39, 174, 96, 0.2);
            color: var(--success-color);
        }

        .step-icon.error {
            background: rgba(231, 76, 60, 0.2);
            color: var(--error-color);
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .step-description {
            font-size: 12px;
            color: var(--text-muted);
        }

        .ip-display {
            font-family: 'Courier New', monospace;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 14px;
            letter-spacing: 1px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .verification-footer {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .verification-btn {
            background: linear-gradient(135deg, var(--primary-green), #7c3aed);
            border: none;
            border-radius: 20px;
            padding: 18px 40px;
            color: white;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 200px;
        }

        .verification-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.4);
        }

        .verification-btn:active {
            transform: translateY(0);
        }

        .verification-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .spinner {
            animation: spin 1s linear infinite;
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .blocked-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #000000, #2c3e50);
            z-index: 10001;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            text-align: center;
        }

        .blocked-icon {
            font-size: 80px;
            margin-bottom: 30px;
            color: var(--error-color);
        }

        .blocked-title {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 20px;
            color: var(--error-color);
        }

        .blocked-reason {
            background: rgba(231, 76, 60, 0.2);
            border: 2px solid var(--error-color);
            border-radius: 20px;
            padding: 25px;
            max-width: 500px;
            width: 100%;
            margin: 20px 0;
        }

        .reason-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 15px;
            color: #fff;
        }

        .reason-details {
            font-size: 14px;
            color: var(--text-muted);
            line-height: 1.6;
        }

        .app-container { padding: 20px; padding-bottom: 110px; max-width: 500px; margin: 0 auto; min-height: 100vh; display: flex; flex-direction: column; }
        
        .content-section { display: none; animation: fadeIn 0.4s ease; }
        .content-section.active { display: flex; flex-direction: column; flex: 1; }
        
        h1 { font-size: 26px; font-weight: 800; color: #fff; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; }
        h2 { font-size: 18px; font-weight: 700; margin: 20px 0 10px; color: var(--gold); display: flex; align-items: center; gap: 8px; }
        p { font-size: 13px; color: var(--text-muted); line-height: 1.4; }
        .page-header { text-align: center; margin-bottom: 20px; padding-top: 10px; }

        .card { 
            background: var(--glass-bg); 
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border-radius: 24px; 
            padding: 20px; 
            margin-bottom: 12px; 
            border: 1px solid var(--glass-border); 
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
        }
        
        .btn { 
            display: flex; align-items: center; justify-content: center; width: 100%; padding: 16px; 
            border-radius: 18px; font-size: 16px; font-weight: 800; cursor: pointer; 
            border: none; outline: none; gap: 8px; text-transform: uppercase; letter-spacing: 0.5px;
            transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.96); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; filter: grayscale(1); }
        
        .btn-primary { 
            background: linear-gradient(90deg, #a855f7, #7c3aed); 
            color: #fff; 
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.4);
        }
        .btn-ton {
            background: linear-gradient(90deg, #0088cc, #0099ff);
            color: #fff;
            box-shadow: 0 0 15px rgba(0, 136, 204, 0.4);
        }
        .btn-check {
            background: linear-gradient(90deg, #a855f7, #7c3aed);
            color: #fff;
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.4);
        }
        .btn-action {
            background: rgba(0, 0, 0, 0.3) !important;
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            color: #b0b0b0 !important;
            flex-direction: column;
            padding: 12px;
            font-size: 12px;
            gap: 5px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .btn-action svg { 
            width: 24px; 
            height: 24px; 
            stroke: #b0b0b0 !important;
            fill: none;
            stroke-width: 2.5;
            transition: all 0.3s ease;
        }

        .btn-action:active {
            background: rgba(0, 0, 0, 0.4) !important;
            transform: scale(0.98);
        }

        .hud-container {
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(0,0,0,0.5); border-radius: 50px;
            padding: 10px 15px; margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.05);
        }
        .user-name { font-weight: 700; font-size: 14px; }
        .user-rank { font-size: 10px; color: var(--primary-green); text-transform: uppercase; }
        .hud-avatar { width: 50px; height: 50px; border-radius: 50%; overflow: hidden; border: 2px solid var(--primary-green); }
        .hud-avatar img { width: 100%; height: 100%; object-fit: cover; }
        
        .hud-balance {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 5px;
        }
        
        .hud-balance-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .hud-glx { color: var(--gold); }
        .hud-ton { color: #0088cc; }
        
        .main-coin-section {
            text-align: center; margin: 10px 0 30px; position: relative;
        }
        .main-coin-img {
            width: 160px; height: 160px; 
            border-radius: 50%; 
            box-shadow: 0 0 50px rgba(168, 85, 247, 0.3);
            animation: float 4s ease-in-out infinite;
            object-fit: cover;
            border: 4px solid var(--primary-green);
        }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
        
        .balance-display { margin-top: 15px; }
        .balance-amount { font-size: 48px; font-weight: 800; background: linear-gradient(to bottom, #fff, #b3b3b3); -webkit-background-clip: text; -webkit-text-fill-color: transparent; line-height: 1; }
        .balance-unit { font-size: 16px; color: var(--primary-green); font-weight: 700; letter-spacing: 2px; }

        .stats-pill {
            display: inline-flex; align-items: center; gap: 15px;
            background: rgba(255,255,255,0.05); padding: 8px 16px; border-radius: 20px;
            margin-top: 10px; font-size: 12px; font-weight: 600;
        }
        .ton-val { color: var(--primary-green); display: flex; align-items: center; gap: 4px; }

        .action-bar { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 25px; }

        .list-card {
            display: flex; align-items: center; 
            background: rgba(0,0,0,0.3); border-radius: 16px; 
            padding: 12px; margin-bottom: 8px;
            border: 1px solid rgba(255,255,255,0.05);
            cursor: pointer;
        }
        .lc-icon { width: 42px; height: 42px; border-radius: 12px; background: rgba(255,255,255,0.05); display: flex; align-items: center; justify-content: center; margin-right: 12px; flex-shrink: 0; }
        .lc-icon img { width: 100%; height: 100%; object-fit: cover; border-radius: 12px; }
        .lc-content { flex: 1; }
        .lc-title { font-size: 14px; font-weight: 600; margin-bottom: 2px; }
        .lc-sub { font-size: 11px; color: var(--text-muted); }
        .lc-end { text-align: right; }
        .lc-val { font-weight: 700; color: var(--primary-green); font-size: 14px; }
        
        .daily-row { display: flex; overflow-x: auto; gap: 8px; padding-bottom: 10px; margin-bottom: 15px; scrollbar-width: none; }
        .daily-box { 
            min-width: 70px; background: rgba(255,255,255,0.05); border-radius: 12px; 
            padding: 10px 5px; text-align: center; border: 1px solid transparent; 
            opacity: 0.5;
        }
        .daily-box.active { opacity: 1; border-color: var(--gold); background: rgba(255, 215, 0, 0.1); }
        .daily-box.claimed { opacity: 1; background: var(--primary-green); color: #000; }
        
        .slots-machine {
            background: rgba(0,0,0,0.6);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid var(--primary-green);
            box-shadow: 0 0 25px rgba(168, 85, 247, 0.4);
        }
        
        .slots-reels {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            gap: 10px;
        }
        
        .reel-container {
            position: relative;
            width: 80px;
            height: 80px;
            overflow: hidden;
            border-radius: 15px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .reel {
            display: flex;
            flex-direction: column;
            transition: transform 2s cubic-bezier(0.1, 0, 0.2, 1);
        }
        
        .slot-item {
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
        }
        
        .slots-result {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 15px;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }
        
        .payout-table {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
            font-size: 11px;
        }
        
        .payout-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 8px;
            text-align: center;
        }
        
        .jackpot {
            color: #FFD700;
            font-weight: 800;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
        }
        
        .podium-list .list-card:nth-child(1) { border-color: #FFD700; background: rgba(255, 215, 0, 0.1); }
        .podium-list .list-card:nth-child(2) { border-color: #C0C0C0; background: rgba(192, 192, 192, 0.1); }
        .podium-list .list-card:nth-child(3) { border-color: #CD7F32; background: rgba(205, 127, 50, 0.1); }
        .podium-list .list-card:nth-child(1) .lc-val { color: #FFD700; }
        .podium-list .list-card:nth-child(2) .lc-val { color: #C0C0C0; }
        .podium-list .list-card:nth-child(3) .lc-val { color: #CD7F32; }
        
        .input-wrap { background: rgba(0,0,0,0.4); border-radius: 16px; padding: 15px; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.1); }
        .input-label { font-size: 11px; color: var(--text-muted); display: block; margin-bottom: 5px; text-transform: uppercase; }
        .custom-input { width: 100%; background: transparent; border: none; color: #fff; font-size: 16px; font-weight: 600; outline: none; font-family: inherit; }
        
        .cat-select { display: flex; gap: 10px; margin-bottom: 20px; }
        .cat-opt { flex: 1; padding: 12px; text-align: center; background: rgba(255,255,255,0.05); border-radius: 12px; font-size: 12px; cursor: pointer; border: 1px solid transparent; }
        .cat-opt.active { background: var(--primary-green); color: #000; border-color: var(--primary-green); font-weight: 700; }
        
        .price-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px; }
        .price-opt { padding: 10px; background: rgba(255,255,255,0.05); border-radius: 10px; text-align: center; cursor: pointer; border: 1px solid transparent; }
        .price-opt.active { border-color: var(--gold); background: rgba(255, 215, 0, 0.1); }
        .price-count { font-size: 14px; font-weight: 700; color: #fff; }
        .price-cost { font-size: 10px; color: var(--primary-green); margin-top: 2px; }

        .terms-box {
            background: rgba(0,0,0,0.3); border-radius: 16px; padding: 15px;
            height: 300px; overflow-y: auto; font-size: 12px; color: var(--text-muted);
            border: 1px solid rgba(255,255,255,0.05); line-height: 1.6;
        }
        .terms-box h3 { color: #fff; font-size: 14px; margin-top: 15px; margin-bottom: 5px; }
        .terms-box h3:first-child { margin-top: 0; }

        .bottom-nav { 
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); 
            width: 90%; max-width: 400px; height: 65px; 
            background: var(--nav-bg); 
            border-radius: 32px; 
            display: flex; justify-content: space-around; align-items: center; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); 
            z-index: 100; border: 1px solid rgba(255,255,255,0.1);
        }
        .nav-item { 
            display: flex; flex-direction: column; align-items: center; 
            color: #666; transition: 0.3s; cursor: pointer; 
            position: relative;
            width: 50px;
        }
        .nav-item svg { 
            width: 22px; height: 22px; margin-bottom: 4px; 
            stroke: currentColor; fill: none; stroke-width: 2.5; 
            transition: all 0.3s;
        }
        .nav-item.active { 
            color: var(--primary-green); transform: translateY(-2px); 
        }
        .nav-item.active svg { 
            stroke: var(--primary-green); 
            filter: drop-shadow(0 0 8px rgba(168, 85, 247, 0.6)); 
        }
        .nav-text { font-size: 9px; font-weight: 700; text-transform: uppercase; }

        .hidden { display: none !important; }
        
        .leader-tabs {
            display: flex;
            background: rgba(0,0,0,0.3);
            border-radius: 50px;
            padding: 4px;
            margin-bottom: 20px;
        }
        
        .tab-btn {
            flex: 1;
            text-align: center;
            padding: 10px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab-btn.active {
            background: var(--primary-green);
            color: #000;
        }

        .withdrawal-type-selector {
            display: flex;
            background: rgba(0,0,0,0.3);
            border-radius: 50px;
            padding: 4px;
            margin-bottom: 20px;
        }
        
        .withdrawal-type-btn {
            flex: 1;
            text-align: center;
            padding: 12px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid transparent;
        }
        
        .withdrawal-type-btn.active {
            background: var(--primary-green);
            color: #000;
            border-color: var(--primary-green);
        }
        
        .info-box {
            background: rgba(255, 179, 0, 0.1);
            border: 1px solid var(--gold);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 15px;
            font-size: 11px;
            line-height: 1.5;
        }
        
        .info-box.success {
            background: rgba(39, 174, 96, 0.1);
            border-color: #27ae60;
        }
        
        .info-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            margin-right: 5px;
            border-radius: 50%;
            background: var(--gold);
            color: #000;
            font-size: 10px;
            font-weight: bold;
        }
        
        .info-box.success .info-icon {
            background: #27ae60;
            color: #fff;
        }

        .floating-add-task {
            position: fixed;
            bottom: 85px;
            left: 50%;
            transform: translateX(-50%);
            width: auto !important;
            min-width: 180px !important;
            max-width: 250px !important;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 12px 20px !important;
            border: 1px solid var(--primary-green);
            box-shadow: 0 5px 30px rgba(168, 85, 247, 0.3);
            z-index: 99;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .floating-add-task:active {
            transform: translateX(-50%) scale(0.98);
        }

        .floating-add-task-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px !important;
        }

        .floating-add-task-icon {
            width: 36px;
            height: 36px;
            background: var(--primary-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            color: #000;
        }

        .floating-add-task-text {
            font-size: 14px !important;
            font-weight: 700;
            color: #fff;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap !important;
        }

        .spins-display {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 12px 15px;
            margin-bottom: 15px;
            border: 1px solid var(--glass-border);
        }

        .spins-count {
            font-size: 20px;
            font-weight: 800;
            color: var(--primary-green);
        }

        .referred-users-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .referred-user-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            margin-bottom: 8px;
        }

        .referred-user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 12px;
            border: 2px solid var(--primary-green);
        }

        .referred-user-info {
            flex: 1;
        }

        .referred-user-name {
            font-size: 14px;
            font-weight: 600;
        }

        .referred-user-date {
            font-size: 11px;
            color: var(--text-muted);
        }

        .referred-user-status {
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 10px;
            background: var(--primary-green);
            color: #000;
            font-weight: 700;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: rgba(168, 85, 247, 0.1);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(168, 85, 247, 0.3);
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary-green);
            margin-top: 5px;
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
        }

        .promo-card, .code-channel-card {
            transition: all 0.3s ease;
            animation: cardFloat 3s ease-in-out infinite alternate;
        }

        @keyframes cardFloat {
            0% { transform: translateY(0); }
            100% { transform: translateY(-5px); }
        }

        .code-channel-card:active {
            transform: scale(0.98);
        }

        #promo-code-input:focus {
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.4);
            border-color: #a855f7;
        }

        /* --- التعديلات الجديدة للتحسين --- */
        
        /* 1. تحسين ظهور زر MAX في الهواتف */
        .max-btn, .withdraw-max-btn {
            min-width: 60px !important;
            height: 44px !important;
            padding: 10px 15px !important;
            font-size: 12px !important;
            font-weight: 800 !important;
            white-space: nowrap !important;
            border: 2px solid rgba(168, 85, 247, 0.5) !important;
            background: rgba(168, 85, 247, 0.2) !important;
            color: white !important;
            border-radius: 12px !important;
            cursor: pointer !important;
        }
        
        /* 2. تحسين زر Competition في Navigation */
        @keyframes cupShine {
            0% { filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.7)); }
            50% { filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.9)); }
            100% { filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.7)); }
        }
        
        /* 3. تأثير Pulse لزر Withdrawals - تم تعديله */
        @keyframes pulseArrow {
            0% { transform: translateY(0); opacity: 1; }
            50% { transform: translateY(-2px); opacity: 0.7; }
            100% { transform: translateY(0); opacity: 1; }
        }
        
        /* 4. تحسين العناصر في الهواتف */
        @media (max-width: 480px) {
            .max-btn, .withdraw-max-btn {
                min-width: 50px !important;
                padding: 8px 12px !important;
                font-size: 11px !important;
                height: 42px !important;
            }
            
            .ticket-input, .bet-input {
                font-size: 16px !important;
                padding: 12px !important;
                height: 44px !important;
            }
            
            /* إصلاح مشكلة ظهور الحقول */
            .coin-bet-controls, .ticket-controls {
                display: flex !important;
                align-items: center !important;
                gap: 8px !important;
                width: 100% !important;
            }
            
            .bet-input, .ticket-input {
                flex: 1 !important;
                min-width: 0 !important;
                font-size: 16px !important;
                padding: 12px !important;
                height: 44px !important;
            }
            
            .app-container { padding: 10px; padding-bottom: 80px; }
            .main-coin-img { width: 120px; height: 120px; }
            .balance-amount { font-size: 36px; }
            .bottom-nav { width: 95%; height: 60px; }
            .nav-text { font-size: 8px; }
            
            .bottom-nav {
                width: 96%;
                padding: 0 5px;
            }
            
            .nav-item {
                width: 45px;
            }
            
            .nav-text {
                font-size: 7px;
            }

            /* تعديلات التحقق للهواتف */
            .verification-card {
                padding: 20px;
                border-radius: 25px;
            }

            .verification-icon {
                font-size: 50px;
            }

            .verification-title {
                font-size: 22px;
            }

            .verification-message {
                font-size: 14px;
                padding: 0 10px;
            }

            .verification-step {
                padding: 12px;
            }
        }
        
        /* ضمان ظهور العناصر بشكل صحيح */
        input[type="number"] {
            -webkit-appearance: none;
            -moz-appearance: textfield;
            appearance: none;
            font-size: 18px !important;
        }
        
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* Coin Flip Game - التعديلات */
        .coin-flip-game {
            background: rgba(0,0,0,0.6);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid var(--primary-green);
            box-shadow: 0 0 25px rgba(168, 85, 247, 0.4);
        }
        
        .coin-bet-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .bet-input {
            flex: 1;
            padding: 12px 15px;
            border-radius: 12px;
            background: rgba(0,0,0,0.3);
            border: 2px solid rgba(168, 85, 247, 0.6);
            color: white;
            font-family: inherit;
            font-size: 16px;
            font-weight: 700;
            text-align: center;
            outline: none;
            min-height: 44px;
        }
        
        .bet-input:focus {
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.6);
            border-color: #a855f7;
        }
        
        .bet-buttons {
            display: flex;
            gap: 8px;
            margin-top: 15px;
        }
        
        .bet-btn {
            padding: 12px 15px;
            background: rgba(168, 85, 247, 0.2);
            border: 2px solid rgba(168, 85, 247, 0.5);
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            font-weight: 700;
            min-width: 65px;
            text-align: center;
            flex: 1;
        }
        
        .bet-btn.active {
            background: linear-gradient(135deg, #a855f7, #7c3aed);
            border-color: #a855f7;
            box-shadow: 0 5px 15px rgba(168, 85, 247, 0.4);
        }
        
        .coin-container {
            width: 150px;
            height: 150px;
            margin: 0 auto 20px;
            perspective: 1000px;
        }
        
        .coin {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transform: rotateY(0deg);
            transition: none;
        }
        
        .coin-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            overflow: hidden;
        }
        
        .coin-face img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .coin-front {
            background: linear-gradient(45deg, #a855f7, #7c3aed);
            transform: rotateY(0deg);
        }
        
        .coin-back {
            background: linear-gradient(45deg, #7c3aed, #a855f7);
            transform: rotateY(180deg);
        }
        
        .gold-side {
            filter: sepia(1) saturate(2) hue-rotate(10deg) brightness(1.2);
        }
        
        @keyframes coinSpin {
            0% { transform: rotateY(0); }
            25% { transform: rotateY(180deg) translateY(-20px); }
            50% { transform: rotateY(360deg) translateY(0); }
            75% { transform: rotateY(540deg) translateY(-10px); }
            100% { transform: rotateY(var(--final-rotation, 720deg)) translateY(0); }
        }
        
        .coin-spinning {
            animation: coinSpin 2.5s cubic-bezier(0.4, 2.4, 0.8, 0.9) forwards;
        }
        
        .coin-final {
            animation: none !important;
            transform: rotateY(var(--final-rotation, 0deg)) !important;
        }
        
        .game-result {
            background: rgba(0,0,0,0.8);
            border-radius: 15px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
        }
        
        .result-text {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .win-amount {
            font-size: 24px;
            font-weight: 800;
            color: #27ae60;
        }
        
        .loss-amount {
            font-size: 24px;
            font-weight: 800;
            color: #e74c3c;
        }

        .bonus-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .bonus-game-card {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--glass-border);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        .bonus-game-card:active {
            transform: scale(0.97);
        }
        
        .game-banner {
            width: 100%;
            height: 120px;
            object-fit: cover;
            display: block;
        }
        
        .game-content {
            padding: 12px;
        }
        
        .game-title {
            font-size: 14px;
            font-weight: 700;
            color: white;
            margin-bottom: 4px;
            text-align: center;
        }
        
        .game-description {
            font-size: 11px;
            color: var(--text-muted);
            text-align: center;
            line-height: 1.3;
        }
        
        .game-icon {
            font-size: 20px;
            margin-bottom: 8px;
            text-align: center;
            color: var(--primary-green);
        }
        
        .side-selection {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .side-btn {
            flex: 1;
            padding: 20px 15px;
            border-radius: 15px;
            background: rgba(255,255,255,0.05);
            border: 2px solid transparent;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            min-height: 140px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .side-btn.active {
            border-color: var(--primary-green);
            background: rgba(168, 85, 247, 0.2);
            box-shadow: 0 5px 20px rgba(168, 85, 247, 0.3);
        }
        
        .side-btn.win {
            border-color: #27ae60;
            background: rgba(39, 174, 96, 0.2);
        }
        
        .side-btn.lose {
            border-color: #e74c3c;
            background: rgba(231, 76, 60, 0.2);
        }
        
        .side-icon {
            font-size: 24px;
            margin-bottom: 10px;
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .side-name {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .side-description {
            font-size: 12px;
            color: var(--text-muted);
            text-align: center;
        }
        
        /* إخفاء قسم الاحتمالات */
        .probability-display {
            display: none !important;
        }
        
        /* تحسينات إضافية للتحسينات المطلوبة */
        
        /* زر Competition جديد على شكل كأس - التعديل */
        .competition-nav-item {
            position: relative;
        }
        
        .competition-nav-icon {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        @keyframes trophyGlow {
            0%, 100% { filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.7)); }
            50% { filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.9)); }
        }
        
        .nav-item.competition-nav-item.active svg {
            animation: trophyGlow 2s infinite alternate;
        }
        
        /* تعديل زر Withdrawals في Navigation - إزالة النقطة */
        .nav-item[data-target="withdrawal-history"] svg {
            filter: drop-shadow(0 0 8px rgba(168, 85, 247, 0.4));
            animation: none;
        }
        
        /* زر Galaxy Log في الهيدر */
        .galaxy-log-icon {
            width: 40px;
            height: 40px;
            background: rgba(168,85,247,0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 1px solid rgba(168,85,247,0.4);
            transition: all 0.3s;
        }
        
        .galaxy-log-icon:hover {
            transform: scale(1.05);
            background: rgba(168,85,247,0.3);
            border-color: #a855f7;
        }
        
        /* تنسيقات Galaxy Log Page */
        .btn-filter {
            padding: 8px 15px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: var(--text-muted);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-filter.active {
            background: var(--primary-green);
            color: #000;
            font-weight: 700;
            border-color: var(--primary-green);
        }
        
        .btn-filter.small {
            padding: 5px 10px;
            font-size: 10px;
        }
        
        .log-stat-card {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 12px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .log-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            margin-bottom: 8px;
            border-left: 4px solid transparent;
        }
        
        .log-item.earn {
            border-left-color: #27ae60;
            background: rgba(39,174,96,0.1);
        }
        
        .log-item.spend {
            border-left-color: #e74c3c;
            background: rgba(231,76,60,0.1);
        }
        
        .log-item.swap {
            border-left-color: #3498db;
            background: rgba(52,152,219,0.1);
        }
        
        .log-item.withdraw {
            border-left-color: #9b59b6;
            background: rgba(155,89,182,0.1);
        }
        
        /* Support Channel Cards */
        .support-channel-card {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .support-channel-card:hover {
            background: rgba(255,255,255,0.08);
            transform: translateY(-2px);
            border-color: rgba(168,85,247,0.4);
        }
        
        /* Deposit Page */
        .deposit-wallet-address {
            background: rgba(0,0,0,0.5);
            padding: 12px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 11px;
            color: #fff;
            word-break: break-all;
            margin-top: 8px;
        }
        
        /* My Withdrawals Page */
        .withdrawal-overview {
            text-align: center;
            margin-bottom: 20px;
        }
        
        /* Coin Game Rules */
        .coin-game-rules {
            margin-top: 25px;
            padding: 20px;
            background: rgba(0,0,0,0.4);
            border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .coin-game-rules h4 {
            font-size: 14px;
            color: var(--gold);
            margin-bottom: 15px;
        }
        
        .coin-game-rules ul {
            font-size: 12px;
            color: var(--text-muted);
            padding-left: 20px;
        }
        
        .coin-game-rules li {
            margin-bottom: 8px;
        }
        
        /* Competition Page Styles */
        .competition-timer-card {
            background: linear-gradient(135deg, 
                rgba(168, 85, 247, 0.2), 
                rgba(123, 97, 255, 0.2));
            border: 2px solid rgba(168, 85, 247, 0.3);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.2);
        }
        
        .countdown-display {
            font-size: 36px;
            font-weight: 800;
            color: #fff;
            text-shadow: 0 0 15px rgba(168, 85, 247, 0.8);
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }
        
        .timer-label {
            font-size: 12px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .status-card {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            border: 1px solid var(--glass-border);
        }
        
        .status-icon {
            font-size: 30px;
            margin-bottom: 10px;
        }
        
        .status-value {
            font-size: 24px;
            font-weight: 800;
            color: #fff;
            margin-bottom: 5px;
        }
        
        .status-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .ticket-price-note {
            background: rgba(168, 85, 247, 0.1);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 12px;
            border: 1px solid rgba(168, 85, 247, 0.3);
        }
        
        .ticket-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .ticket-input {
            flex: 1;
            padding: 15px;
            border-radius: 12px;
            background: rgba(0,0,0,0.3);
            border: 2px solid rgba(168, 85, 247, 0.5);
            color: white;
            font-size: 18px;
            font-weight: 700;
            text-align: center;
            outline: none;
            min-height: 44px;
        }
        
        .competition-leaderboard {
            margin-top: 25px;
        }
        
        .leaderboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .previous-winners-card {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid var(--glass-border);
        }
        
        .winner-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            margin-bottom: 10px;
        }
        
        .winner-rank {
            width: 30px;
            height: 30px;
            background: var(--primary-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            margin-right: 15px;
        }
        
        .winner-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 12px;
            border: 2px solid var(--primary-green);
        }
        
        .winner-info {
            flex: 1;
        }
        
        .winner-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 2px;
        }
        
        .winner-date {
            font-size: 10px;
            color: var(--text-muted);
        }
        
        .winner-prize {
            font-size: 14px;
            font-weight: 700;
            color: var(--primary-green);
        }
        
        /* إضافة زر max لصفحة السحب */
        .withdraw-max-btn {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(168, 85, 247, 0.2);
            border: 1px solid rgba(168, 85, 247, 0.5);
            border-radius: 8px;
            padding: 6px 12px;
            color: white;
            font-size: 10px;
            cursor: pointer;
            font-weight: 700;
            z-index: 10;
        }
        
        /* تعديلات الكوين فليب */
        .bet-btn.k-style {
            min-width: 55px;
            padding: 10px 12px;
            font-size: 13px;
            flex: 1;
        }
        
        /* Withdrawal History في الصفحة الرئيسية */
        .user-withdrawal-item {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .withdrawal-status {
            font-size: 10px;
            padding: 3px 10px;
            border-radius: 20px;
            font-weight: 700;
        }
        
        .status-completed {
            background: rgba(39, 174, 96, 0.2);
            color: #27ae60;
        }
        
        .status-pending {
            background: rgba(255, 193, 7, 0.2);
            color: #FFC107;
        }
        
        .status-rejected {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }
        
        .masked-email {
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
        }
        
        /* Competition Top 10 Leaderboard */
        .competition-rank-card {
            display: flex;
            align-items: center;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            margin-bottom: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .competition-rank {
            width: 30px;
            font-weight: 800;
            font-size: 14px;
            text-align: center;
            margin-right: 10px;
        }
        
        .rank-1 .competition-rank {
            color: #27ae60;
            font-weight: 900;
        }
        
        .rank-2 .competition-rank {
            color: #C0C0C0;
        }
        
        .rank-3 .competition-rank {
            color: #CD7F32;
        }
        
        .competition-user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            margin-right: 12px;
            border: 2px solid var(--primary-green);
        }
        
        .competition-user-info {
            flex: 1;
        }
        
        .competition-user-name {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 2px;
        }
        
        .competition-ticket-count {
            font-size: 14px;
            font-weight: 700;
            color: var(--primary-green);
        }
        
        /* Competition Rules Card */
        .competition-rules-card {
            background: rgba(0,0,0,0.4);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .rules-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: var(--gold);
            font-size: 16px;
            font-weight: 700;
        }
        
        .rules-list {
            font-size: 12px;
            color: var(--text-muted);
            line-height: 1.6;
            padding-left: 20px;
        }
        
        .rules-list li {
            margin-bottom: 8px;
        }
        
        .winner-highlight {
            color: #27ae60;
            font-weight: 700;
        }
        
        .loser-note {
            color: #e74c3c;
            font-weight: 600;
        }
        
        .important-note {
            background: rgba(255, 193, 7, 0.1);
            border-left: 3px solid #FFC107;
            padding: 10px;
            margin-top: 15px;
            border-radius: 5px;
            font-size: 11px;
        }
        
        /* SWAP التحويل ثنائي الاتجاه */
        .swap-direction-selector {
            display: flex;
            background: rgba(0,0,0,0.3);
            border-radius: 50px;
            padding: 4px;
            margin-bottom: 20px;
        }
        
        .swap-direction-btn {
            flex: 1;
            text-align: center;
            padding: 12px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid transparent;
        }
        
        .swap-direction-btn.active {
            background: var(--primary-green);
            color: #000;
            border-color: var(--primary-green);
        }
        
        /* تحسينات لصفحة السحب لتتناسق مع Swap */
        .withdraw-input-with-max {
            position: relative;
        }
        
        .withdraw-input-with-max .custom-input {
            padding-right: 70px;
        }
        
        .email-display {
            font-family: 'Courier New', monospace;
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.2);
            font-size: 16px;
            letter-spacing: 2px;
            color: white;
            text-align: center;
            margin-top: 10px;
        }
        
        .swap-mode-text {
            font-size: 12px;
            color: var(--text-muted);
            text-align: center;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <!-- نظام التحقق والأمان Overlay -->
    <div id="verification-overlay" class="verification-overlay">
        <div class="verification-card fade-in">
            <div class="verification-icon" id="verification-main-icon">🔒</div>
            <div class="verification-title" id="verification-title">Security Verification</div>
            <div class="verification-message" id="verification-message">Checking your access credentials...</div>
            
            <div class="verification-details">
                <div class="verification-step checking" id="step-telegram">
                    <div class="step-icon checking">
                        <i class="fab fa-telegram"></i>
                    </div>
                    <div class="step-content">
                        <div class="step-title">Telegram App Check</div>
                        <div class="step-description" id="telegram-status">Verifying Telegram WebApp context...</div>
                    </div>
                </div>
                
                <div class="verification-step checking" id="step-ip">
                    <div class="step-icon checking">
                        <i class="fas fa-network-wired"></i>
                    </div>
                    <div class="step-content">
                        <div class="step-title">IP Address Check</div>
                        <div class="step-description" id="ip-status">Checking IP address...</div>
                    </div>
                </div>
                
                <div class="verification-step checking" id="step-vpn">
                    <div class="step-icon checking">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="step-content">
                        <div class="step-title">VPN Detection</div>
                        <div class="step-description" id="vpn-status">Checking VPN status...</div>
                    </div>
                </div>
                
                <div class="verification-step checking" id="step-device">
                    <div class="step-icon checking">
                        <i class="fas fa-fingerprint"></i>
                    </div>
                    <div class="step-content">
                        <div class="step-title">Device Fingerprint</div>
                        <div class="step-description" id="device-status">Checking device fingerprint...</div>
                    </div>
                </div>
            </div>
            
            <div class="ip-display" id="ip-display" style="display: none;">
                Your IP: <span id="current-ip">Loading...</span>
            </div>
            
            <button class="verification-btn" id="retry-verification" style="display: none;">
                <i class="fas fa-redo"></i> Retry Verification
            </button>
            
            <div class="verification-footer">
                <i class="fas fa-info-circle"></i> For security reasons, this bot only works inside the official Telegram app.
            </div>
        </div>
    </div>

    <!-- Blocked Overlay -->
    <div id="blocked-overlay" class="blocked-overlay" style="display: none;">
        <div class="blocked-icon">🚫</div>
        <div class="blocked-title">ACCESS BLOCKED</div>
        
        <div class="blocked-reason">
            <div class="reason-title" id="blocked-reason-title">Security Violation Detected</div>
            <div class="reason-details" id="blocked-reason-details">
                Your access has been blocked due to security policy violations.
            </div>
        </div>
        
        <div class="verification-footer" style="margin-top: 30px;">
            <i class="fas fa-exclamation-triangle"></i> This is an automated security measure. If this is an error, contact support.
        </div>
    </div>

    <!-- Main App Content (Hidden until verification passes) -->
    <div id="main-app" style="display: none;">
        <div class="app-container">
            
            <!-- HEADER -->
            <div class="hud-container">
                <div>
                    <div class="user-name" id="home-username">Explorer</div>
                    <div class="user-rank" id="home-user-level" style="display: none;"></div>
                    <div style="display: flex; align-items: center; gap: 15px; margin-top: 5px;">
                        <div class="stats-pill" style="margin: 0; padding: 6px 12px;">
                            <span style="color: var(--gold);">GLX:</span>
                            <span id="hud-glx-balance" style="color: #fff; font-weight: 700;">0</span>
                        </div>
                        <div class="stats-pill" style="margin: 0; padding: 6px 12px;">
                            <span style="color: var(--gold);">TON:</span>
                            <span id="hud-ton-balance" style="color: #fff; font-weight: 700;">0.0000</span>
                        </div>
                    </div>
                </div>
                <div style="display:flex; align-items:center; gap:10px;">
                    <!-- إضافة أيقونة Galaxy Log -->
                    <div class="galaxy-log-icon" id="galaxy-log-button">
                        <span style="font-size: 20px;">📜</span>
                    </div>
                    <div class="hud-avatar">
                        <img src="https://i.ibb.co/tTkJX1Qy/logo.png" alt="User">
                    </div>
                </div>
            </div>

            <!-- HOME SECTION -->
            <main id="home" class="content-section active">
                <div class="main-coin-section">
                    <img src="https://i.ibb.co/tTkJX1Qy/logo.png" class="main-coin-img" alt="GLX">
                    <div class="balance-display">
                        <div class="balance-amount" id="total-GLX-balance">0</div>
                        <div class="balance-unit">GLX</div>
                    </div>
                    <div class="stats-pill">
                        <span class="ton-val"><img src="https://i.ibb.co/8DsyHqwK/toncoin-ton-logo.png" style="width:16px; border-radius:50%;"> <span id="home-ton-balance">0.0000</span> TON</span>
                        <span style="opacity:0.3">|</span>
                        <span style="font-size:10px; opacity:0.8;">100K = 0.01 TON</span>
                    </div>
                </div>

                <div class="action-bar">
                    <div class="btn btn-action nav-link" data-target="swap-page">
                        <svg viewBox="0 0 24 24"><path d="M7 16V4m0 0L3 8m4-4 4 4m6 0v12m0 0 4-4m-4 4-4-4"/></svg>
                        <span>Swap</span>
                    </div>
                    <div class="btn btn-action nav-link" data-target="withdraw">
                        <svg viewBox="0 0 24 24"><path d="M12 5v14m0 0-6-6m6 6 6-6"/></svg>
                        <span>Withdraw</span>
                    </div>
                    <!-- My Withdrawals أصبح في المركز الثالث -->
                    <div class="btn btn-action nav-link" data-target="user-withdrawals">
                        <svg viewBox="0 0 24 24">
                            <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/>
                            <line x1="4" y1="22" x2="4" y2="15"/>
                        </svg>
                        <span>My Withdrawals</span>
                    </div>
                    <!-- Deposit أصبح في المركز الرابع -->
                    <div class="btn btn-action nav-link" data-target="deposit">
                        <svg viewBox="0 0 24 24"><path d="M12 5v14m0 0-6-6m6 6 6-6" transform="rotate(180,12,12)"/></svg>
                        <span>Deposit</span>
                    </div>
                </div>

                <!-- Payments Channel & Support -->
                <!-- خانة Payments Channel (قناة المدفوعات) -->
                <div class="card" style="margin-top: 15px;">
                    <h2 style="display: flex; align-items: center; gap: 8px;">
                        <i class="fa-solid fa-credit-card"></i>
                        Payments Channel
                    </h2>
                    
                    <div class="support-channel-card" onclick="window.open('https://t.me/earnmoney139482', '_blank')">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #a855f7, #7b61ff); 
                                        border-radius: 12px; display: flex; align-items: center; 
                                        justify-content: center; font-size: 24px; color: white;">
                                <i class="fab fa-telegram"></i>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 14px; font-weight: 700; color: white; margin-bottom: 5px;">
                                    Payments & Withdrawals Channel
                                </div>
                                <div style="font-size: 11px; color: var(--text-muted);">
                                    Track payments, withdrawals, and transaction updates
                                </div>
                                <div style="font-size: 10px; color: #ffb300; margin-top: 5px;">
                                    <i class="fa-solid fa-users"></i> @earnmoney139482
                                </div>
                            </div>
                            <div style="color: var(--primary-green); font-size: 18px;">
                                <i class="fa-solid fa-arrow-right"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- خانتي الدعم -->
                <div class="card" style="margin-top: 12px;">
                    <h2 style="display: flex; align-items: center; gap: 8px;">
                        <i class="fa-solid fa-headset"></i>
                        Support & Help
                    </h2>
                    
                    <!-- الدعم الأول: Support 1 -->
                    <div class="support-channel-card" onclick="window.open('https://t.me/aborabie777', '_blank')" style="margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #3498db, #2980b9); 
                                        border-radius: 12px; display: flex; align-items: center; 
                                        justify-content: center; font-size: 24px; color: white;">
                                <i class="fa-solid fa-user-gear"></i>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 14px; font-weight: 700; color: white; margin-bottom: 5px;">
                                    Technical Support
                                </div>
                                <div style="font-size: 11px; color: var(--text-muted);">
                                    Get help with technical issues and account problems
                                </div>
                            </div>
                            <div style="color: #3498db; font-size: 18px;">
                                <i class="fa-solid fa-arrow-right"></i>
                            </div>
                        </div>
                    </div>
                    
                    <!-- الدعم الثاني: Support 2 -->
                    <div class="support-channel-card" onclick="window.open('https://t.me/Elsayed_1_Elgohary', '_blank')">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #27ae60, #2ecc71); 
                                        border-radius: 12px; display: flex; align-items: center; 
                                        justify-content: center; font-size: 24px; color: white;">
                                <i class="fa-solid fa-circle-question"></i>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 14px; font-weight: 700; color: white; margin-bottom: 5px;">
                                    General Support & FAQ
                                </div>
                                <div style="font-size: 11px; color: var(--text-muted);">
                                    Get answers to common questions and general help
                                </div>
                            </div>
                            <div style="color: #27ae60; font-size: 18px;">
                                <i class="fa-solid fa-arrow-right"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- إضافة قنوات التحديثات والأكواد -->
                <div class="card" style="margin-top: 12px;">
                    <h2 style="display: flex; align-items: center; gap: 8px;">
                        <i class="fa-solid fa-bullhorn"></i>
                        Updates & News
                    </h2>
                    
                    <!-- قناة التحديثات -->
                    <div class="support-channel-card" onclick="window.open('https://t.me/earnmoney174688', '_blank')" style="margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #9b59b6, #8e44ad); 
                                        border-radius: 12px; display: flex; align-items: center; 
                                        justify-content: center; font-size: 24px; color: white;">
                                <i class="fa-solid fa-bell"></i>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 14px; font-weight: 700; color: white; margin-bottom: 5px;">
                                    Bot Updates & News
                                </div>
                                <div style="font-size: 11px; color: var(--text-muted);">
                                    Latest updates, announcements, and news about the bot
                                </div>
                                <div style="font-size: 10px; color: #9b59b6; margin-top: 5px;">
                                    <i class="fa-solid fa-users"></i> @earnmoney174688
                                </div>
                            </div>
                            <div style="color: #9b59b6; font-size: 18px;">
                                <i class="fa-solid fa-arrow-right"></i>
                            </div>
                        </div>
                    </div>
                    
                    <!-- قناة الأكواد -->
                    <div class="support-channel-card" onclick="window.open('https://t.me/earnmoney1685', '_blank')">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #e74c3c, #c0392b); 
                                        border-radius: 12px; display: flex; align-items: center; 
                                        justify-content: center; font-size: 24px; color: white;">
                                <i class="fa-solid fa-gift"></i>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 14px; font-weight: 700; color: white; margin-bottom: 5px;">
                                    Codes & Rewards Channel
                                </div>
                                <div style="font-size: 11px; color: var(--text-muted);">
                                    Daily promo codes, rewards, and special bonuses
                                </div>
                                <div style="font-size: 10px; color: #e74c3c; margin-top: 5px;">
                                    <i class="fa-solid fa-users"></i> @earnmoney1685
                                </div>
                            </div>
                            <div style="color: #e74c3c; font-size: 18px;">
                                <i class="fa-solid fa-arrow-right"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- باقي الصفحات (تم اختصارها للتركيز على نظام التحقق) -->
            <!-- GALAXY LOG PAGE -->
            <main id="galaxy-log-page" class="content-section">
                <!-- محتوى الصفحة -->
            </main>

            <!-- DEPOSIT PAGE -->
            <main id="deposit" class="content-section">
                <!-- محتوى الصفحة -->
            </main>

            <!-- باقي الصفحات الأخرى -->
            <!-- ... -->

        </div>

        <!-- Floating Add Task Button -->
        <div class="floating-add-task hidden" id="floatingAddTask" onclick="switchTab('create-task-page')">
            <div class="floating-add-task-content">
                <div class="floating-add-task-icon">+</div>
                <div class="floating-add-task-text">Add Task</div>
            </div>
        </div>

        <!-- NAVIGATION BAR -->
        <nav class="bottom-nav">
            <div class="nav-item active" data-target="home">
                <svg viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg>
                <span class="nav-text">Home</span>
            </div>
            <div class="nav-item" data-target="tasks">
                <svg viewBox="0 0 24 24"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>
                <span class="nav-text">Tasks</span>
            </div>
            <div class="nav-item" data-target="bonus">
                <svg viewBox="0 0 24 24"><path d="M20 12V8H6a2 2 0 0 1-2-2c0-1.1.9-2 2-2h12v4"></path><path d="M4 6v12c0 1.1.9 2 2 2h14v-4"></path><path d="M18 12a2 2 0 0 0-2 2c0 1.1.9 2 2 2h4v-4h-4z"></path></svg>
                <span class="nav-text">Bonus</span>
            </div>
            <!-- Competition بأيقونة جديدة -->
            <div class="nav-item competition-nav-item" data-target="competition">
                <div class="competition-nav-icon">
                    <svg viewBox="0 0 32 32" width="28" height="28">
                        <!-- خلفية النجم المتوهجة -->
                        <circle cx="16" cy="16" r="14" fill="rgba(255, 215, 0, 0.15)" opacity="0.8"/>
                        
                        <!-- الشعار الرئيسي (تاج + نجمة) -->
                        <!-- التاج -->
                        <path d="M9 13 L16 8 L23 13 L21 21 L11 21 Z" 
                              fill="none" 
                              stroke="#FFD700" 
                              stroke-width="2" 
                              stroke-linecap="round" 
                              stroke-linejoin="round"/>
                        
                        <!-- النجمة فوق التاج -->
                        <path d="M16 5 L17.5 10 L22 10 L18.5 13 L19.5 18 L16 15 L12.5 18 L13.5 13 L10 10 L14.5 10 Z" 
                              fill="#FFD700" 
                              stroke="#FFA500" 
                              stroke-width="1.5"/>
                        
                        <!-- شارة المسابقة -->
                        <circle cx="16" cy="16" r="6" fill="none" stroke="#FFD700" stroke-width="1.5" stroke-dasharray="2 2"/>
                        
                        <!-- تأثير التوهج -->
                        <circle cx="16" cy="16" r="8" fill="none" stroke="rgba(255, 215, 0, 0.3)" stroke-width="3"/>
                    </svg>
                </div>
                <span class="nav-text">Competition</span>
            </div>
            <div class="nav-item" data-target="referrals">
                <svg viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                <span class="nav-text">Referrals</span>
            </div>
            <div class="nav-item" data-target="withdrawal-history">
                <svg viewBox="0 0 24 24" style="filter: drop-shadow(0 0 8px rgba(168, 85, 247, 0.4));">
                    <path d="M12 2v20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M8 12l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span class="nav-text">Withdrawals</span>
            </div>
        </nav>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // ==================== نظام التحقق والأمان ====================
            class SecurityVerification {
                constructor() {
                    this.verificationOverlay = document.getElementById('verification-overlay');
                    this.blockedOverlay = document.getElementById('blocked-overlay');
                    this.mainApp = document.getElementById('main-app');
                    this.verificationSteps = {
                        telegram: document.getElementById('step-telegram'),
                        ip: document.getElementById('step-ip'),
                        vpn: document.getElementById('step-vpn'),
                        device: document.getElementById('step-device')
                    };
                    this.statusElements = {
                        telegram: document.getElementById('telegram-status'),
                        ip: document.getElementById('ip-status'),
                        vpn: document.getElementById('vpn-status'),
                        device: document.getElementById('device-status')
                    };
                    this.retryBtn = document.getElementById('retry-verification');
                    
                    // Firebase Configuration
                    const firebaseConfig = {
                        apiKey: "AIzaSyC5dwRaz3L-aK7I5CoPkbB31MzXB62lgrU",
                        authDomain: "earnmoney124553.firebaseapp.com",
                        databaseURL: "https://earnmoney124553-default-rtdb.firebaseio.com",
                        projectId: "earnmoney124553",
                        storageBucket: "earnmoney124553.firebasestorage.app",
                        messagingSenderId: "325528918523",
                        appId: "1:325528918523:web:73d84f48a24c1e0cbfd35e",
                        measurementId: "G-G1H96Q5XCJ"
                    };
                    
                    // Initialize Firebase
                    firebase.initializeApp(firebaseConfig);
                    this.db = firebase.database();
                    
                    // User Information
                    this.user = this.getUser();
                    this.deviceFingerprint = this.generateDeviceFingerprint();
                    this.userIP = null;
                    
                    // Bind methods
                    this.showVerificationMessage = this.showVerificationMessage.bind(this);
                    this.updateStepStatus = this.updateStepStatus.bind(this);
                    this.startVerification = this.startVerification.bind(this);
                    this.blockAccess = this.blockAccess.bind(this);
                    this.grantAccess = this.grantAccess.bind(this);
                    
                    // Setup event listeners
                    this.setupEventListeners();
                }
                
                getUser() {
                    const tgUser = window.Telegram?.WebApp?.initDataUnsafe?.user;
                    if (tgUser) { 
                        return { 
                            id: tgUser.id.toString(), 
                            first_name: tgUser.first_name, 
                            last_name: tgUser.last_name || '', 
                            username: tgUser.username || '' 
                        }; 
                    }
                    return { 
                        id: 'guest_' + Date.now(), 
                        first_name: 'Guest', 
                        last_name: 'User', 
                        username: 'guest' 
                    };
                }
                
                generateDeviceFingerprint() {
                    // Generate unique device fingerprint
                    const components = [
                        navigator.userAgent,
                        navigator.platform,
                        navigator.language,
                        screen.width + 'x' + screen.height,
                        navigator.hardwareConcurrency || 'unknown',
                        new Date().getTimezoneOffset()
                    ].join('|');
                    
                    // Simple hash function
                    let hash = 0;
                    for (let i = 0; i < components.length; i++) {
                        const char = components.charCodeAt(i);
                        hash = ((hash << 5) - hash) + char;
                        hash = hash & hash;
                    }
                    return hash.toString(16);
                }
                
                setupEventListeners() {
                    // Retry button
                    this.retryBtn.addEventListener('click', () => {
                        this.startVerification();
                    });
                }
                
                showVerificationMessage(icon, title, message, isError = false) {
                    document.getElementById('verification-main-icon').textContent = icon;
                    document.getElementById('verification-title').textContent = title;
                    document.getElementById('verification-message').textContent = message;
                    
                    if (isError) {
                        document.getElementById('verification-main-icon').style.color = 'var(--error-color)';
                        this.retryBtn.style.display = 'flex';
                    } else {
                        document.getElementById('verification-main-icon').style.color = 'var(--success-color)';
                        this.retryBtn.style.display = 'none';
                    }
                }
                
                updateStepStatus(step, status, message) {
                    const stepElement = this.verificationSteps[step];
                    const statusElement = this.statusElements[step];
                    
                    if (!stepElement || !statusElement) return;
                    
                    // Remove all classes
                    stepElement.classList.remove('checking', 'success', 'error');
                    stepElement.querySelector('.step-icon').classList.remove('checking', 'success', 'error');
                    
                    // Add appropriate class
                    stepElement.classList.add(status);
                    stepElement.querySelector('.step-icon').classList.add(status);
                    
                    // Update message
                    statusElement.textContent = message;
                    
                    // Update icon based on status
                    const icon = stepElement.querySelector('.step-icon i');
                    if (status === 'success') {
                        icon.className = 'fas fa-check-circle';
                    } else if (status === 'error') {
                        icon.className = 'fas fa-times-circle';
                    } else if (status === 'checking') {
                        icon.className = 'fas fa-spinner fa-spin';
                    }
                }
                
                async checkTelegramApp() {
                    this.updateStepStatus('telegram', 'checking', 'Checking Telegram WebApp...');
                    
                    return new Promise((resolve) => {
                        setTimeout(() => {
                            if (!window.Telegram || !window.Telegram.WebApp) {
                                this.updateStepStatus('telegram', 'error', '❌ Telegram WebApp not detected');
                                this.showVerificationMessage('🚫', 'Access Denied', 'Please open this bot inside the official Telegram app only.', true);
                                this.blockAccess('telegram_app', 'This bot only works inside the official Telegram app. Please open it through Telegram.');
                                resolve(false);
                                return;
                            }
                            
                            // Check if running in Telegram WebView
                            const isTelegramWebView = window.Telegram.WebApp.platform !== 'unknown';
                            
                            if (!isTelegramWebView) {
                                this.updateStepStatus('telegram', 'error', '❌ Not in Telegram WebView');
                                this.showVerificationMessage('🚫', 'Invalid Environment', 'Please use the official Telegram app, not Telegram Web.', true);
                                this.blockAccess('telegram_web', 'Telegram Web is not supported. Please use the official Telegram app.');
                                resolve(false);
                                return;
                            }
                            
                            this.updateStepStatus('telegram', 'success', '✅ Valid Telegram WebApp detected');
                            resolve(true);
                        }, 1000);
                    });
                }
                
                async getIPAddress() {
                    this.updateStepStatus('ip', 'checking', 'Fetching IP address...');
                    
                    try {
                        // Try multiple IP services
                        const ipServices = [
                            'https://api.ipify.org?format=json',
                            'https://api.my-ip.io/ip.json',
                            'https://ipinfo.io/json'
                        ];
                        
                        let ip = null;
                        
                        for (const service of ipServices) {
                            try {
                                const response = await fetch(service, { 
                                    method: 'GET',
                                    headers: { 'Accept': 'application/json' },
                                    timeout: 5000
                                });
                                
                                if (response.ok) {
                                    const data = await response.json();
                                    ip = data.ip || data.query || null;
                                    if (ip) break;
                                }
                            } catch (error) {
                                console.log(`IP service ${service} failed:`, error);
                            }
                        }
                        
                        if (!ip) {
                            throw new Error('Could not fetch IP address');
                        }
                        
                        this.userIP = ip;
                        this.updateStepStatus('ip', 'success', `✅ IP: ${this.maskIP(ip)}`);
                        
                        // Show IP display
                        document.getElementById('ip-display').style.display = 'block';
                        document.getElementById('current-ip').textContent = ip;
                        
                        return ip;
                    } catch (error) {
                        this.updateStepStatus('ip', 'error', '❌ Failed to get IP address');
                        return null;
                    }
                }
                
                maskIP(ip) {
                    // Mask IP for display (show only first two octets)
                    const parts = ip.split('.');
                    if (parts.length === 4) {
                        return `${parts[0]}.${parts[1]}.***.***`;
                    }
                    return ip;
                }
                
                async checkVPN(ip) {
                    this.updateStepStatus('vpn', 'checking', 'Checking VPN status...');
                    
                    if (!ip) {
                        this.updateStepStatus('vpn', 'error', '❌ No IP address available');
                        return false;
                    }
                    
                    try {
                        // Simple VPN detection (check for known VPN/Proxy IP ranges)
                        // Note: This is a basic check. For production, use a proper VPN detection service
                        
                        // Check for common VPN patterns
                        const vpnPatterns = [
                            /^10\./,      // Private network
                            /^172\.(1[6-9]|2[0-9]|3[0-1])\./, // Private network
                            /^192\.168\./, // Private network
                            /^100\.(6[4-9]|[7-9][0-9]|1[0-1][0-9]|12[0-7])\./, // CGNAT
                        ];
                        
                        const isPrivateIP = vpnPatterns.some(pattern => pattern.test(ip));
                        
                        if (isPrivateIP) {
                            this.updateStepStatus('vpn', 'error', '❌ Private/VPN IP detected');
                            this.showVerificationMessage('🚫', 'VPN Detected', 'VPN usage is not allowed for security reasons.', true);
                            this.blockAccess('vpn_detected', 'VPN or proxy usage detected. Please disable your VPN and try again.');
                            return false;
                        }
                        
                        this.updateStepStatus('vpn', 'success', '✅ Clean IP (No VPN detected)');
                        return true;
                    } catch (error) {
                        this.updateStepStatus('vpn', 'error', '❌ VPN check failed');
                        return false;
                    }
                }
                
                async checkDeviceFingerprint() {
                    this.updateStepStatus('device', 'checking', 'Checking device fingerprint...');
                    
                    try {
                        // Check if this device fingerprint is already registered
                        const fingerprintRef = this.db.ref(`security/device_fingerprints/${this.deviceFingerprint}`);
                        const snapshot = await fingerprintRef.once('value');
                        
                        if (snapshot.exists()) {
                            const data = snapshot.val();
                            // Check if this is the same user
                            if (data.userId !== this.user.id) {
                                this.updateStepStatus('device', 'error', '❌ Device already registered by another user');
                                this.showVerificationMessage('🔒', 'Device Conflict', 'This device is already registered with another account.', true);
                                this.blockAccess('device_registered', 'This device is already registered with another account. Each device can only have one account.');
                                return false;
                            }
                        }
                        
                        // Register or update device fingerprint
                        await fingerprintRef.set({
                            userId: this.user.id,
                            ip: this.userIP,
                            timestamp: Date.now(),
                            userAgent: navigator.userAgent
                        });
                        
                        this.updateStepStatus('device', 'success', '✅ Device fingerprint verified');
                        return true;
                    } catch (error) {
                        this.updateStepStatus('device', 'error', '❌ Device check failed');
                        return false;
                    }
                }
                
                async checkExistingUser() {
                    // Check if user already exists in database
                    const userRef = this.db.ref(`users/${this.user.id}`);
                    const snapshot = await userRef.once('value');
                    
                    if (snapshot.exists()) {
                        const userData = snapshot.val();
                        
                        // Check if user is banned
                        if (userData.banned === true) {
                            this.showVerificationMessage('🚫', 'Account Banned', `Your account has been banned. Reason: ${userData.banReason || 'Violation of rules'}`, true);
                            this.blockAccess('account_banned', `Account banned: ${userData.banReason || 'Violation of rules'}`);
                            return false;
                        }
                        
                        // Check device registration for existing user
                        const deviceRef = this.db.ref(`security/user_devices/${this.user.id}`);
                        const deviceSnapshot = await deviceRef.once('value');
                        
                        if (deviceSnapshot.exists()) {
                            const deviceData = deviceSnapshot.val();
                            if (deviceData.deviceFingerprint !== this.deviceFingerprint) {
                                this.updateStepStatus('device', 'error', '❌ New device detected for existing account');
                                this.showVerificationMessage('🔒', 'New Device', 'A new device was detected for your account. For security, please use your original device.', true);
                                this.blockAccess('new_device', 'New device detected for existing account. For security reasons, please use your original device.');
                                return false;
                            }
                        } else {
                            // First time login, register device
                            await deviceRef.set({
                                deviceFingerprint: this.deviceFingerprint,
                                firstLogin: Date.now(),
                                ip: this.userIP
                            });
                        }
                        
                        return true; // Existing user, skip multi-account checks
                    }
                    
                    return null; // New user
                }
                
                async checkMultiAccount() {
                    // Only check for new users
                    this.updateStepStatus('device', 'checking', 'Checking for duplicate accounts...');
                    
                    try {
                        // Check if same IP has multiple accounts
                        const ipRef = this.db.ref(`security/ip_addresses/${this.userIP.replace(/\./g, '_')}`);
                        const snapshot = await ipRef.once('value');
                        
                        if (snapshot.exists()) {
                            const ipData = snapshot.val();
                            const accountCount = ipData.accountCount || 0;
                            
                            if (accountCount >= 3) { // Allow up to 3 accounts per IP
                                this.updateStepStatus('device', 'error', '❌ Too many accounts from this IP');
                                this.showVerificationMessage('🚫', 'Account Limit Reached', 'Maximum account limit reached for this IP address.', true);
                                this.blockAccess('multi_account', 'Too many accounts detected from this IP address. Maximum allowed: 3 accounts per IP.');
                                return false;
                            }
                            
                            // Update IP counter
                            await ipRef.update({
                                accountCount: accountCount + 1,
                                lastUsed: Date.now()
                            });
                        } else {
                            // First account from this IP
                            await ipRef.set({
                                accountCount: 1,
                                firstUsed: Date.now(),
                                lastUsed: Date.now()
                            });
                        }
                        
                        return true;
                    } catch (error) {
                        this.updateStepStatus('device', 'error', '❌ Multi-account check failed');
                        return false;
                    }
                }
                
                blockAccess(reasonCode, message) {
                    this.verificationOverlay.style.display = 'none';
                    this.blockedOverlay.style.display = 'flex';
                    
                    document.getElementById('blocked-reason-title').textContent = 
                        reasonCode === 'telegram_app' ? 'Telegram App Required' :
                        reasonCode === 'telegram_web' ? 'Invalid Environment' :
                        reasonCode === 'vpn_detected' ? 'VPN Detected' :
                        reasonCode === 'device_registered' ? 'Device Already Registered' :
                        reasonCode === 'account_banned' ? 'Account Banned' :
                        reasonCode === 'new_device' ? 'New Device Detected' :
                        reasonCode === 'multi_account' ? 'Multiple Accounts Detected' :
                        'Security Violation';
                    
                    document.getElementById('blocked-reason-details').textContent = message;
                }
                
                grantAccess() {
                    this.showVerificationMessage('✅', 'Access Granted', 'Verification successful! Welcome to GLX Galaxy.');
                    
                    setTimeout(() => {
                        this.verificationOverlay.style.display = 'none';
                        this.mainApp.style.display = 'block';
                        
                        // Initialize main app
                        this.initializeMainApp();
                    }, 1500);
                }
                
                async startVerification() {
                    // Reset UI
                    this.verificationOverlay.style.display = 'flex';
                    this.blockedOverlay.style.display = 'none';
                    this.mainApp.style.display = 'none';
                    this.retryBtn.style.display = 'none';
                    
                    this.showVerificationMessage('🔒', 'Security Verification', 'Checking your access credentials...');
                    
                    // Step 1: Check Telegram App
                    const telegramValid = await this.checkTelegramApp();
                    if (!telegramValid) return;
                    
                    // Step 2: Check if user already exists
                    const existingUser = await this.checkExistingUser();
                    if (existingUser === false) return; // Banned or device conflict
                    
                    // Step 3: Get IP Address
                    const ip = await this.getIPAddress();
                    if (!ip && existingUser === null) { // Only require IP for new users
                        this.updateStepStatus('ip', 'error', '❌ IP check failed');
                        this.showVerificationMessage('⚠️', 'Connection Issue', 'Could not verify your connection. Please check your internet and try again.', true);
                        this.retryBtn.style.display = 'flex';
                        return;
                    }
                    
                    // Step 4: Check VPN (only for new users)
                    if (existingUser === null) {
                        const vpnClean = await this.checkVPN(ip);
                        if (!vpnClean) return;
                    }
                    
                    // Step 5: Check Device Fingerprint
                    const deviceValid = await this.checkDeviceFingerprint();
                    if (!deviceValid) return;
                    
                    // Step 6: Check Multi-Account (only for new users)
                    if (existingUser === null) {
                        const multiAccountClean = await this.checkMultiAccount();
                        if (!multiAccountClean) return;
                    }
                    
                    // All checks passed
                    this.grantAccess();
                }
                
                initializeMainApp() {
                    // ==================== Main App Configuration ====================
                    const BOT_USERNAME = 'CashJungleBot'; 
                    const ADMIN_WALLET = 'UQCg1DjKHH1_guXQ0TFmkvj09igxYwEJGfKPijLaHyOHIPTX';
                    const GLX_TO_TON_RATE = 0.0000001;
                    const TON_TO_GLX_RATE = 10000000;
                    const TICKET_PRICE = 10000;
                    const TICKET_TON_VALUE = 0.001;
                    const COMPETITION_DURATION = 24 * 60 * 60 * 1000;
                    const BREAK_DURATION = 60 * 60 * 1000;
                    const ADSGRAM_BLOCK_ID = 'int-18879';
                    const TG_BOT_TOKEN = '8340000265:AAErFZF0d-khnKM8LxU0pU8T140-DdZLncQ';

                    let appData = {}, appSettings = {};
                    let isAdScriptLoaded = false;
                    let isLeaderboardLoaded = false;
                    let AdController = null;
                    
                    // Create Task Variables
                    let selectedCategory = 'channel';
                    let selectedCount = 100;
                    let selectedCost = 0.15;
                    let currentTaskId = '';

                    // Slots Game Variables
                    let isSpinning = false;
                    const slotsSymbols = ['🌟', '🪐', '💫', '⭐', '🚀', '🌌'];
                    const slotsPayouts = {
                        '🌟🌟🌟': 10000,
                        '🪐🪐🪐': 5000,
                        '💫💫💫': 2500,
                        '⭐⭐⭐': 1200,
                        '🌟🌟': 700,
                        'default': 500
                    };

                    // Coin Flip Game Variables
                    let coinGame = {
                        isFlipping: false,
                        chosenSide: 'glx',
                        betAmount: 1000,
                        lastFlipResult: null,
                        winChance: 45,
                        lossChance: 55,
                        currentRotation: 0,
                        animationId: null
                    };

                    // Withdrawal Type
                    let withdrawalType = 'faucetpay';

                    // Swap Direction
                    let swapDirection = 'glx_to_ton';

                    // Competition Variables
                    let competitionInterval = null;
                    let countdownInterval = null;
                    let competitionData = {
                        isActive: true,
                        startTime: Date.now(),
                        endTime: Date.now() + COMPETITION_DURATION,
                        totalTickets: 0,
                        prizePool: 0,
                        userTickets: 0,
                        winners: []
                    };

                    // Ad click protection
                    let lastAdClickTime = 0;
                    const AD_CLICK_DELAY = 3000;

                    // Deposit variables
                    let currentDepositAmount = 0;
                    let currentDepositMemo = '';
                    let depositCheckInterval = null;

                    // ==================== Main App Functions ====================
                    // (يتم وضع هنا جميع دوال التطبيق الرئيسية الموجودة في الكود الأصلي)
                    // ... [جميع الدوال الموجودة في script الأصلي] ...
                    
                    // Note: بسبب طول الكود، تم اختصار هذا الجزء للتركيز على نظام التحقق
                    // يمكنك إضافة باقي الدوال هنا كما هي موجودة في script الأصلي
                    
                    console.log("Main app initialized for user:", this.user);
                }
            }

            // Start verification when page loads
            const securitySystem = new SecurityVerification();
            securitySystem.startVerification();
        });
    </script>
</body>
</html>

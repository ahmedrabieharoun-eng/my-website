<!DOCTYPE html>
<html lang="bn">
<head>
    <meta name='admaven-placement' content='Bqja6qdC7'>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>TON Rewards</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <style>
        /* Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ù…Ø§Ø· ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ */
        :root {
            --font-family: 'Poppins', sans-serif;
            --primary-color: #0088cc;
            --secondary-color: #00bcd4;
            --accent-color: #ff9800;
            --background-light: #f0f8ff;
            --surface-light: #ffffff;
            --text-primary-light: #1a237e;
            --text-secondary-light: #546e7a;
            --border-light: #bbdefb;
            --background-dark: #0a1a2a;
            --surface-dark: #1a2b3c;
            --text-primary-dark: #e3f2fd;
            --text-secondary-dark: #90a4ae;
            --border-dark: #37474f;
            --success: #4caf50;
            --danger: #f44336;
            --pending: #ff9800;
            --ship-gold: #ffd700;
            --ship-silver: #c0c0c0;
            --ocean-blue: #006994;
            --deck-wood: #8b4513;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: var(--font-family); 
            transition: background-color 0.3s, color 0.3s; 
            -webkit-font-smoothing: antialiased;
            background: linear-gradient(135deg, var(--background-dark) 0%, #0a2a3a 100%);
            color: var(--text-primary-dark);
            overflow-x: hidden;
        }

        /* Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£Ø®Ø±Ù‰ ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ */
        .ship-container {
            position: relative;
            max-width: 500px;
            margin: 0 auto;
            min-height: 100vh;
            background: linear-gradient(to bottom, #0a1a2a 0%, #0a2a3a 50%, #0a3a4a 100%);
            box-shadow: 0 0 30px rgba(0, 100, 200, 0.3);
            overflow: hidden;
        }

        /* ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù†Ù…Ø§Ø· ... */

    </style>
</head>
<body>
    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø­Ø¸Ø± -->
    <div id="banned-page" class="banned-container">
        <div class="banned-icon">ğŸš«</div>
        <div class="banned-title">Account Banned</div>
        <div class="banned-message" id="banned-reason">Your account has been suspended for violating our terms of service.</div>
        <div class="banned-contact">If you believe this is a mistake, please contact @aborabie777</div>
    </div>

    <!-- Ø§Ù„Ù†Ø¬ÙˆÙ… ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ© -->
    <div class="stars" id="stars"></div>

    <div id="app-loader">
        <div class="ship-wheel-loader ship-floating">
            <div class="ship-wheel"></div>
        </div>
        <p id="loading-text">Preparing Your Ship...</p>
    </div>
    
    <!-- Ø§Ù„Ø¨ÙˆØ¨ Ø£Ø¨ -->
    <div id="popup" class="popup-overlay">
        <div class="popup-content">
            <div id="popup-body"></div>
        </div>
    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ -->
    <div id="subscription-page" style="display: none;">
        <div class="subscription-container">
            <h2 style="color: var(--ship-gold); margin-bottom: 10px;">ğŸ“¢ Required Subscription</h2>
            <p style="margin-bottom: 20px;">You must subscribe to our channels to use the bot and earn rewards!</p>
            
            <div id="channels-list">
                <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>
            
            <!-- Ù‚Ø³Ù… Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù‚Ù†ÙˆØ§Øª -->
            <div id="ad-channels-section" style="margin-top: 30px; display: none;">
                <h3 style="color: var(--ship-gold); margin-bottom: 15px;">ğŸ¯ Advertised Channels</h3>
                <p style="margin-bottom: 15px; font-size: 0.9rem;">Subscribe to these channels for extra rewards!</p>
                <div id="ad-channels-list">
                    <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                </div>
                <p style="margin-top: 15px; font-size: 0.8rem; color: var(--text-secondary-dark); text-align: center;">
                    ğŸ’¡ Want to advertise your channel here? Contact @aborabie777
                </p>
            </div>
            
            <button id="check-subscription-btn" class="check-subscription-btn" style="margin-top: 20px; width: 100%;">
                ğŸ”„ Check Subscription
            </button>
            
            <p style="margin-top: 15px; font-size: 0.9rem; opacity: 0.8;">
                After subscribing, click the button above to verify
            </p>

            <!-- Ø²Ø± Ø§Ù„ØªØ®Ø·ÙŠ Ù„Ù„ØªØ·ÙˆÙŠØ± ÙÙ‚Ø· -->
            <button id="skip-subscription-btn" style="margin-top: 10px; padding: 8px 15px; background: transparent; color: var(--ship-gold); border: 1px solid var(--ship-gold); border-radius: 5px; cursor: pointer; font-size: 0.8rem;">
                ğŸš¨ Skip for Testing (Dev Only)
            </button>
        </div>
    </div>

    <!-- ØªØµÙ…ÙŠÙ… Ø§Ù„Ø³ÙÙŠÙ†Ø© -->
    <div class="ship-container" style="display: none;">
        <!-- Ø§Ù„Ø£Ù…ÙˆØ§Ø¬ -->
        <div class="wave"></div>
        <div class="wave wave-2"></div>

        <!-- Ø§Ù„Ø¬Ø³Ø± (Ø§Ù„Ø±Ø£Ø³) Ø§Ù„Ù…Ø¹Ø¯Ù„ -->
        <header class="ship-bridge">
            <img id="user-photo" src="https://via.placeholder.com/80" alt="User">
            <div class="user-info-compact">
                <h1 id="user-name">Loading...</h1>
                <div class="balance-display-compact">
                    <div class="balance-item-compact">Main: <span id="user-balance">0.0000</span> TON</div>
                    <div class="balance-item-compact">RR: <span id="user-rr-balance">0</span></div>
                </div>
            </div>
            <div class="ship-compass">
                <i class="fas fa-compass"></i>
            </div>
        </header>

        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <main id="main-content">
            <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰ -->
        </main>

        <!-- Ø¹Ø¬Ù„Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙÙ„ÙŠØ©) -->
        <nav class="ship-controls">
            <!-- Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© -->
        </nav>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const tg = window.Telegram?.WebApp || {};
        
        // âœ… Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase
        const firebaseConfig = JSON.parse(atob("eyJhcGlLZXkiOiJBSXphU3lBazkwOUNGblc0Wk1lQkVNMXl4UmJRYlc5dzZVTm81OCIsImF1dGhEb21haW4iOiJlYXJuLW1vbmV5LWMzYmFkLmZpcmViYXNlYXBwLmNvbSIsImRhdGFiYXNlVVJMIjoiaHR0cHM6Ly9lYXJuLW1vbmV5LWMzYmFkLWRlZmF1bHQtcnRkYi5maXJlYmFzZWlvLmNvbSIsInByb2plY3RJZCI6ImVhcm4tbW9uZXktYzNiYWQiLCJzdG9yYWdlQnVja2V0IjoiZWFybi1tb25leS1jM2JhZC5maXJlYmFzZXN0b3JhZ2UuYXBwIiwibWVzc2FnaW5nU2VuZGVySWQiOiIxMDIyNjg4NTY2MDExIiwiYXBwSWQiOiIxOjEwMjI2ODg1NjYwMTE6d2ViOjY5MGY2ZmFhMTlkZDMzMzdhMmVlNWUiLCJtZWFzdXJlbWVudElkIjoiRy0wQ0gxTEJGTEgyIn0="));

        // âœ… Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„Ø§Ø´ØªØ±Ø§Ùƒ
        const requiredChannels = [
            {
                id: 'earnmoney174688',
                name: 'Earn Money Public',
                username: 'earnmoney174688',
                url: 'https://t.me/earnmoney174688',
                icon: 'https://img.icons8.com/ios-filled/100/group.png'
            },
            {
                id: 'earnmoney139482',
                name: 'Earn Money Withdrawals',
                username: 'earnmoney139482', 
                url: 'https://t.me/earnmoney139482',
                icon: 'https://img.icons8.com/ios-filled/100/money-bag.png'
            },
            {
                id: 'earnmoneywithredone',
                name: 'Earn Money With Redone',
                username: 'EarnMoneyWithRedone',
                url: 'https://t.me/EarnMoneyWithRedone',
                icon: 'https://img.icons8.com/ios-filled/100/rocket.png'
            }
        ];

        let isSubscribedToAllChannels = false;

        // âœ… Ø¯Ø§Ù„Ø© Ù…Ø­Ø³Ù†Ø© Ù„ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ - Ù…Ø¹ Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
        const updateSubscriptionUI = (subscriptionResults) => {
            const channelsList = document.getElementById('channels-list');
            channelsList.innerHTML = '';
            
            subscriptionResults.forEach(channel => {
                const channelElement = document.createElement('div');
                channelElement.className = 'channel-item';
                
                let statusText = 'âŒ Not Subscribed';
                let statusClass = 'status-not-subscribed';
                
                if (channel.subscribed) {
                    statusText = 'âœ… Subscribed';
                    statusClass = 'status-subscribed';
                } else if (channel.error) {
                    statusText = 'âš ï¸ Check Failed';
                    statusClass = 'status-not-subscribed';
                }
                
                channelElement.innerHTML = `
                    <div class="channel-info">
                        <img src="${channel.icon}" alt="${channel.name}" class="channel-icon">
                        <div style="text-align: left;">
                            <h4 style="margin: 0; font-size: 1rem;">${channel.name}</h4>
                            <small style="opacity: 0.7;">@${channel.username}</small>
                        </div>
                    </div>
                    <span class="channel-status ${statusClass}">
                        ${statusText}
                    </span>
                    <button class="action-btn join-channel-btn" data-channel-url="${channel.url}" style="padding: 8px 12px; font-size: 0.8rem;">
                        Join
                    </button>
                `;
                channelsList.appendChild(channelElement);
            });

            // âœ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: Ø§Ø³ØªØ®Ø¯Ø§Ù… event delegation Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠÙ† ÙØ±Ø¯ÙŠÙŠÙ†
            setupJoinButtons();
        };

        // âœ… Ø¯Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø²Ø±Ø§Ø± Join Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… event delegation
        const setupJoinButtons = () => {
            // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ù…Ø³ØªÙ…Ø¹ÙŠÙ† Ø³Ø§Ø¨Ù‚ÙŠÙ† Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
            document.getElementById('channels-list').removeEventListener('click', handleJoinButtonClick);
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ ÙˆØ§Ø­Ø¯ Ù„Ù„Ø¹Ù†ØµØ± Ø§Ù„Ø£Ø¨ (event delegation)
            document.getElementById('channels-list').addEventListener('click', handleJoinButtonClick);
        };

        // âœ… Ø¯Ø§Ù„Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£Ø²Ø±Ø§Ø± Join
        const handleJoinButtonClick = (event) => {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Join Ø£Ùˆ Ø£Ø­Ø¯ Ø¹Ù†Ø§ØµØ±Ù‡ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©
            const joinButton = event.target.closest('.join-channel-btn');
            
            if (joinButton) {
                const channelUrl = joinButton.getAttribute('data-channel-url');
                console.log('ğŸ¯ Join button clicked, opening:', channelUrl);
                openChannel(channelUrl);
            }
        };

        // âœ… Ø¯Ø§Ù„Ø© Ù„ÙØªØ­ Ø§Ù„Ù‚Ù†Ø§Ø©
        const openChannel = (url) => {
            console.log('ğŸ”— Opening channel:', url);
            
            // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ù…Ø±Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø±
            const button = event.target.closest('.join-channel-btn');
            if (button) {
                button.style.transform = 'scale(0.95)';
                button.style.opacity = '0.7';
                setTimeout(() => {
                    button.style.transform = '';
                    button.style.opacity = '';
                }, 200);
            }
            
            // ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·
            try {
                if (tg.openLink) {
                    tg.openLink(url);
                } else {
                    window.open(url, '_blank', 'noopener,noreferrer');
                }
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯
                if (tg.showAlert) {
                    tg.showAlert('Opening channel... Please subscribe and return to this page.');
                }
            } catch (error) {
                console.error('Error opening channel:', error);
                window.open(url, '_blank', 'noopener,noreferrer');
            }
        };

        // âœ… Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ù†ÙˆØ§Øª
        const checkAllSubscriptions = async () => {
            console.log('ğŸ” Checking channel subscriptions...');
            
            const subscriptionResults = [];
            
            for (const channel of requiredChannels) {
                try {
                    // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ (ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… API)
                    const isSubscribed = false; // Ø³ÙŠØªÙ… ØªØºÙŠÙŠØ± Ù‡Ø°Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹
                    
                    subscriptionResults.push({
                        ...channel,
                        subscribed: isSubscribed
                    });
                    
                    await new Promise(resolve => setTimeout(resolve, 500));
                } catch (channelError) {
                    console.error(`âŒ Error checking channel ${channel.username}:`, channelError);
                    subscriptionResults.push({
                        ...channel,
                        subscribed: false,
                        error: true
                    });
                }
            }
            
            const allSubscribed = subscriptionResults.every(channel => channel.subscribed);
            isSubscribedToAllChannels = allSubscribed;
            
            console.log('ğŸ“Š Subscription results:', subscriptionResults);
            
            return { 
                subscriptionResults, 
                allSubscribed
            };
        };

        // âœ… Ø¯Ø§Ù„Ø© Ù…Ø­Ø³Ù†Ø© Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        const initApp = async () => {
            try {
                console.log('ğŸš€ Starting app initialization...');
                
                if (tg.ready) { 
                    tg.ready(); 
                    try { 
                        tg.expand(); 
                    } catch(e){} 
                }
                
                // Ù…Ø­Ø§ÙƒØ§Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù„ØªØ¬Ø±Ø¨Ø©
                const userData = {
                    id: 'test_user_' + Date.now(),
                    firstName: 'Test',
                    lastName: 'User'
                };
                
                console.log('ğŸ“± App initialized with user:', userData);

                // Ø¹Ø±Ø¶ ØµÙØ­Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„ØªØ¬Ø±Ø¨Ø©
                document.getElementById('app-loader').style.display = 'none';
                document.getElementById('subscription-page').style.display = 'block';
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª ÙˆØ¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                const { subscriptionResults } = await checkAllSubscriptions();
                updateSubscriptionUI(subscriptionResults);
                
                // âœ… Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ø²Ø± Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ
                document.getElementById('check-subscription-btn').addEventListener('click', async () => {
                    console.log('ğŸ”„ Checking subscriptions...');
                    
                    const btn = document.getElementById('check-subscription-btn');
                    btn.disabled = true;
                    btn.innerHTML = 'ğŸ”„ Checking...';
                    
                    // Ù…Ø­Ø§ÙƒØ§Ø© Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­Ù‚Ù‚
                    setTimeout(async () => {
                        const newResults = await checkAllSubscriptions();
                        updateSubscriptionUI(newResults.subscriptionResults);
                        
                        btn.disabled = false;
                        btn.innerHTML = 'ğŸ”„ Check Subscription';
                        
                        if (newResults.allSubscribed) {
                            if (tg.showAlert) {
                                tg.showAlert('ğŸ‰ All channels subscribed! You can now use the app.');
                            }
                        } else {
                            if (tg.showAlert) {
                                tg.showAlert('Please subscribe to all channels first!');
                            }
                        }
                    }, 2000);
                });

                // âœ… Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ø²Ø± Ø§Ù„ØªØ®Ø·ÙŠ
                document.getElementById('skip-subscription-btn').addEventListener('click', () => {
                    if (confirm('ğŸš¨ Skip subscription for testing?')) {
                        console.log('â­ï¸ Skipping subscription for testing');
                        document.getElementById('subscription-page').style.display = 'none';
                        document.querySelector('.ship-container').style.display = 'block';
                    }
                });
                
            } catch (error) { 
                console.error("Initialization failed:", error); 
            }
        };

        // âœ… Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        initApp();
    });

    // Ø¥Ø¶Ø§ÙØ© keyframes Ù„Ù„Ù€ spinner
    (function addSpinKeyframes(){ 
        const style = document.createElement('style'); 
        style.innerHTML='@keyframes spin{to{transform:rotate(360deg)}}'; 
        document.head.appendChild(style); 
    })();
    </script>
</body>
</html>
